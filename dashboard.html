<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>KIforME Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f7fa;
      margin: 0;
      padding: 20px;
    }
    h1 {
      text-align: center;
    }
    .status-section, .report-section, .filter-section, .trades-section {
      margin: 20px auto;
      max-width: 800px;
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .status-btn {
      display: inline-block;
      padding: 10px 20px;
      margin: 5px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
    }
    .active {
      background: #4caf50;
      color: #fff;
    }
    .paused {
      background: #f44336;
      color: #fff;
    }
    .neutral {
      background: #607d8b;
      color: #fff;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }
    th {
      background: #e0e0e0;
    }
    .filter-input {
      margin-right: 10px;
      padding: 6px;
    }
    @media (max-width: 600px) {
      table, th, td {
        font-size: 12px;
      }
      .status-btn {
        width: 100%;
        margin: 5px 0;
      }
    }
  </style>
</head>
<body>
  <h1>KIforME Dashboard</h1>

  <div class="status-section">
    <h2>Status & Verbindungen</h2>
    <button id="traderStatusBtn" class="status-btn paused" onclick="toggleTraderStatus()">Trader: Pausiert</button>
    <button id="avaStatusBtn" class="status-btn neutral" onclick="toggleConnection('ava')">AvaTrade: Nicht verbunden</button>
    <button id="nagaStatusBtn" class="status-btn neutral" onclick="toggleConnection('naga')">NAGA: Nicht verbunden</button>
  </div>

  <div class="report-section">
    <h2>Tagesreport</h2>
    <a href="daily_report.pdf" download>ðŸ“„ PDF-Report herunterladen</a>
  </div>

  <div class="filter-section">
    <h2>Trade-Filter</h2>
    <input type="text" id="traderFilter" class="filter-input" placeholder="Tradername" oninput="renderTrades()" />
    <select id="platformFilter" class="filter-input" onchange="renderTrades()">
      <option value="">Alle Plattformen</option>
      <option value="ava">AvaTrade</option>
      <option value="naga">NAGA</option>
    </select>
  </div>

  <div class="trades-section">
    <h2>Offene Trades</h2>
    <table>
      <thead>
        <tr>
          <th>Trader</th>
          <th>Plattform</th>
          <th>Symbol</th>
          <th>Lot</th>
          <th>Richtung</th>
          <th>SL</th>
          <th>TP</th>
        </tr>
      </thead>
      <tbody id="tradesTable">
        <!-- Dynamisch gefÃ¼llt -->
      </tbody>
    </table>
  </div>

  <script>
    let traderActive = false;
    let avaConnected = false;
    let nagaConnected = false;

    const mockTrades = [
      { trader: 'AlphaBot', platform: 'ava', symbol: 'EURUSD', lot: 0.2, dir: 'Buy', sl: 1.0840, tp: 1.0950 },
      { trader: 'BetaAI', platform: 'naga', symbol: 'DAX', lot: 0.5, dir: 'Sell', sl: 16300, tp: 15700 },
      { trader: 'AlphaBot', platform: 'ava', symbol: 'BTCUSD', lot: 0.1, dir: 'Buy', sl: 58000, tp: 62000 },
      { trader: 'GammaTrader', platform: 'naga', symbol: 'Gold', lot: 1, dir: 'Sell', sl: 2370, tp: 2280 }
    ];

    function toggleTraderStatus() {
      traderActive = !traderActive;
      const btn = document.getElementById('traderStatusBtn');
      btn.textContent = `Trader: ${traderActive ? 'Aktiv' : 'Pausiert'}`;
      btn.className = `status-btn ${traderActive ? 'active' : 'paused'}`;
    }

    function toggleConnection(type) {
      if (type === 'ava') {
        avaConnected = !avaConnected;
        const btn = document.getElementById('avaStatusBtn');
        btn.textContent = `AvaTrade: ${avaConnected ? 'Verbunden' : 'Nicht verbunden'}`;
        btn.className = `status-btn ${avaConnected ? 'active' : 'neutral'}`;
      } else if (type === 'naga') {
        nagaConnected = !nagaConnected;
        const btn = document.getElementById('nagaStatusBtn');
        btn.textContent = `NAGA: ${nagaConnected ? 'Verbunden' : 'Nicht verbunden'}`;
        btn.className = `status-btn ${nagaConnected ? 'active' : 'neutral'}`;
      }
      renderTrades();
    }

    function renderTrades() {
      const table = document.getElementById('tradesTable');
      const traderFilter = document.getElementById('traderFilter').value.toLowerCase();
      const platformFilter = document.getElementById('platformFilter').value;

      table.innerHTML = '';
      mockTrades.forEach(trade => {
        const matchTrader = !traderFilter || trade.trader.toLowerCase().includes(traderFilter);
        const matchPlatform = !platformFilter || trade.platform === platformFilter;
        const platformConnected = (trade.platform === 'ava' && avaConnected) || (trade.platform === 'naga' && nagaConnected);

        if (matchTrader && matchPlatform && platformConnected) {
          const row = `
            <tr>
              <td>${trade.trader}</td>
              <td>${trade.platform.toUpperCase()}</td>
              <td>${trade.symbol}</td>
              <td>${trade.lot}</td>
              <td>${trade.dir}</td>
              <td>${trade.sl}</td>
              <td>${trade.tp}</td>
            </tr>
          `;
          table.innerHTML += row;
        }
      });
    }

    // Initial rendering (leer, bis Verbindung aktiv)
    renderTrades();
  </script>
</body>
</html>