<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>KIforME Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #f4f4f4;
    }
    header {
      background: #1e90ff;
      color: white;
      padding: 1rem;
      text-align: center;
    }
    main {
      padding: 1rem;
    }
    .status {
      margin-bottom: 1rem;
      padding: 0.5rem;
      background: #e0e0e0;
      border-radius: 6px;
    }
    .button-group {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 1rem;
    }
    button {
      flex: 1 1 150px;
      padding: 0.7rem;
      font-size: 1rem;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .active { background: #28a745; color: white; }
    .inactive { background: #dc3545; color: white; }
    .section {
      margin-bottom: 1rem;
    }
    .trade-table {
      width: 100%;
      border-collapse: collapse;
    }
    .trade-table th, .trade-table td {
      border: 1px solid #ccc;
      padding: 0.4rem;
      text-align: left;
    }
    .trade-table th {
      background: #f0f0f0;
    }
    .filter-group {
      margin: 0.5rem 0;
    }
    #pdf-container {
      border: 1px solid #ccc;
      height: 400px;
      overflow: auto;
      margin-bottom: 1rem;
    }
    @media (max-width: 600px) {
      .button-group { flex-direction: column; }
    }
  </style>
</head>
<body>
  <header>
    <h1>KIforME Copytrading Dashboard</h1>
  </header>
  <main>
    <div class="status">
      <strong>KI-Modus:</strong> <span id="ki-status">Hybrid (manuell)</span>
    </div>

    <div class="button-group">
      <button id="toggle-ki" class="active">KI auf Vollautomatik umstellen</button>
      <button id="connect-ava" class="active">AvaTrade verbunden</button>
      <button id="connect-naga" class="active">NAGA verbunden</button>
    </div>

    <div class="filter-group">
      <label for="filter-platform">Plattform:</label>
      <select id="filter-platform">
        <option value="all">Alle</option>
        <option value="AvaTrade">AvaTrade</option>
        <option value="NAGA">NAGA</option>
      </select>

      <label for="filter-trader">Trader:</label>
      <select id="filter-trader">
        <option value="all">Alle</option>
        <option value="Trader01">Trader01</option>
        <option value="Trader02">Trader02</option>
      </select>
    </div>

    <div class="section">
      <h2>Offene Positionen</h2>
      <table class="trade-table" id="trades-table">
        <thead>
          <tr>
            <th>Symbol</th>
            <th>Plattform</th>
            <th>Richtung</th>
            <th>Lots</th>
            <th>SL/TP</th>
            <th>Trader</th>
          </tr>
        </thead>
        <tbody>
          <!-- Dynamisch gefÃ¼llt -->
        </tbody>
      </table>
    </div>

    <div class="section">
      <h2>Tagesreport (PDF)</h2>
      <div id="pdf-container">PDF wird geladenâ€¦</div>
      <a id="download-link" href="#" download="Tagesreport.pdf">ðŸ“¥ PDF herunterladen</a>
    </div>
  </main>

  <script>
    let kiModus = 'Hybrid';

    document.getElementById("toggle-ki").onclick = function () {
      kiModus = kiModus === 'Hybrid' ? 'Vollautomatik' : 'Hybrid';
      document.getElementById("ki-status").textContent = kiModus + (kiModus === 'Hybrid' ? " (manuell)" : " (KI-gesteuert)");
      this.textContent = kiModus === 'Hybrid' ? 'KI auf Vollautomatik umstellen' : 'KI auf Hybrid umstellen';
    };

    const trades = [
      { symbol: 'EUR/USD', platform: 'AvaTrade', direction: 'Buy', lots: 0.1, sltp: '1.0932/1.0998', trader: 'Trader01' },
      { symbol: 'BTC/USD', platform: 'NAGA', direction: 'Sell', lots: 0.2, sltp: '35500/31200', trader: 'Trader02' },
      { symbol: 'DAX', platform: 'AvaTrade', direction: 'Buy', lots: 1.0, sltp: '18100/18900', trader: 'Trader01' },
    ];

    function renderTrades() {
      const platformFilter = document.getElementById("filter-platform").value;
      const traderFilter = document.getElementById("filter-trader").value;
      const tbody = document.getElementById("trades-table").querySelector("tbody");
      tbody.innerHTML = "";

      trades
        .filter(t => (platformFilter === "all" || t.platform === platformFilter) &&
                     (traderFilter === "all" || t.trader === traderFilter))
        .forEach(t => {
          const row = `<tr>
            <td>${t.symbol}</td>
            <td>${t.platform}</td>
            <td>${t.direction}</td>
            <td>${t.lots}</td>
            <td>${t.sltp}</td>
            <td>${t.trader}</td>
          </tr>`;
          tbody.innerHTML += row;
        });
    }

    document.getElementById("filter-platform").onchange = renderTrades;
    document.getElementById("filter-trader").onchange = renderTrades;

    renderTrades();

    // PDF Mock-Inhalt
    const pdfHtml = `
      <h3>ðŸ“Š Tagesreport â€“ 26.07.2025</h3>
      <ul>
        <li>3 geprÃ¼fte Setups</li>
        <li>2 ausgefÃ¼hrte Trades</li>
        <li>Gesamt-P/L: +94â€¯â‚¬</li>
        <li>Gewinnquote: 66%</li>
        <li>Letzter Trade: EUR/USD Buy, +37â€¯â‚¬</li>
      </ul>
    `;

    document.getElementById("pdf-container").innerHTML = pdfHtml;

    // Download-Link vorbereiten
    const blob = new Blob([pdfHtml], { type: "text/html" });
    const url = URL.createObjectURL(blob);
    document.getElementById("download-link").href = url;
  </script>
</body>
</html>